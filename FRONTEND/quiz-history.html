<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>Quiz History | Language Learning Platform</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
</head>

<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Main -->
		<div id="main">
			<div class="inner">

				<!-- Header -->
				<header id="header">
					<a href="index.html" class="logo"><strong>LangLearn</strong> Dashboard</a>
					<ul class="icons">
						<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="#" class="icon brands fa-snapchat-ghost"><span class="label">Snapchat</span></a>
						</li>
						<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="#" class="icon brands fa-medium-m"><span class="label">Medium</span></a></li>
					</ul>
				</header>

				<!-- Banner -->
				<section id="banner">
					<div class="content">
						<header>
							<h1>Your Quiz History</h1>
							<a href="dashboard.html" class="button small">‚Üê Back to Dashboard</a>
							<p>Review your performance and track your learning progress.</p>
						</header>
					</div>
					<span class="image object">
						<img src="images/quiz-history.jpg" alt="" />
					</span>
				</section>

				<!-- Section -->
				<section>
					<header class="major">
						<h2>Quiz Performance Summary</h2>
					</header>
					<div id="quizHistoryList">
						<!-- Quiz history records will be loaded here dynamically -->
					</div>
				</section>

			</div>
		</div>

		<!-- Sidebar -->
		<div id="sidebar">
			<div class="inner">

				<!-- Search -->
				<section id="search" class="alt">
					<form method="post" action="#">
						<input type="text" name="query" id="query" placeholder="Search" />
					</form>
				</section>

				<!-- Menu -->
				<nav id="menu">
					<header class="major">
						<h2>Menu</h2>
					</header>
					<ul>
						<li><a href="dashboard.html">Dashboard</a></li>
						<li><a href="quiz.html">Take a Quiz</a></li>
						<li><a href="quiz-history.html">Quiz History</a></li>
						<li><a href="settings.html">Settings</a></li>
						<li><a href="#" onclick="logout()">Logout</a></li>
					</ul>
				</nav>

				<!-- Section -->
				<section>
					<header class="major">
						<h2>Ante interdum</h2>
					</header>
					<div class="mini-posts">
						<article>
							<a href="#" class="image"><img src="images/pic07.jpg" alt="" /></a>
							<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore aliquam.</p>
						</article>
						<article>
							<a href="#" class="image"><img src="images/pic08.jpg" alt="" /></a>
							<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore aliquam.</p>
						</article>
						<article>
							<a href="#" class="image"><img src="images/pic09.jpg" alt="" /></a>
							<p>Aenean ornare velit lacus, ac varius enim lorem ullamcorper dolore aliquam.</p>
						</article>
					</div>
					<ul class="actions">
						<li><a href="#" class="button">More</a></li>
					</ul>
				</section>

				<!-- Section -->
				<section>
					<header class="major">
						<h2>Get in touch</h2>
					</header>
					<p>If you have any questions or feedback, feel free to reach out. We're here to support your language learning journey!</p>
					<ul class="contact">
						<li class="icon solid fa-envelope"><a href="#">support@langlearn.com</a></li>
						<li class="icon solid fa-phone">(000) 000-0000</li>
						<li class="icon solid fa-home">1234 Somewhere Road #8254<br />
							Nashville, TN 00000-0000</li>
					</ul>
				</section>

				<!-- Footer -->
				<footer id="footer">
					<p class="copyright">
						&copy; 2025 LangLearn. Built with <a href="https://html5up.net">HTML5 UP</a>.
					</p>
				</footer>

			</div>
		</div>

	</div>

	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>

	<script>
		document.addEventListener("DOMContentLoaded", function () {
			const token = localStorage.getItem("token");
			const user = JSON.parse(localStorage.getItem("user"));
			const historyContainer = document.getElementById("quizHistoryList");

			if (!token || !user || !user.id) {
				window.location.href = "login.html"; // üîÅ Redirect to login
				return;
			}

			historyContainer.innerHTML = "<p>Loading quiz history...</p>";

			fetch(`http://localhost:8080/api/quiz-results/user/${user.id}`, {
				headers: {
					"Authorization": `Bearer ${token}`
				}
			})
				.then(response => {
					if (!response.ok) {
						throw new Error("Failed to fetch quiz history");
					}
					return response.json();
				})
				.then(data => {
					data.reverse(); // Show the most recent quizzes first
					if (data.length === 0) {
						historyContainer.innerHTML = "<p>No quiz results found.</p>";
						return;
					}

					const listHtml = data.map(result => `
						<div class="box">
							<h3>${new Date(result.dateSubmitted).toLocaleDateString()}</h3>
							<p>Correct: ${result.correctAnswers} / ${result.totalQuestions}</p>
							<p>Score: ${(result.correctAnswers / result.totalQuestions * 100).toFixed(1)}%</p>
						</div>
					`).join("");

					historyContainer.innerHTML = listHtml;
				})
				.catch(error => {
					console.error(error);
					historyContainer.innerHTML = "<p>Error loading quiz history.</p>";
				});
		});
	</script>

</body>

</html>